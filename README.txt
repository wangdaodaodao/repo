================================================================================
                    越狱插件仓库 - 使用说明
================================================================================

【仓库简介】
这是一个 Cydia/Sileo 越狱插件源仓库，用于托管和分发 arm64 架构的越狱插件。

================================================================================
一、目录结构说明
================================================================================

repo/
├── dylib/              # 存放待打包的 .dylib 和 .zip 文件
├── debs/               # 存放已打包的 .deb 文件
├── Packages            # 插件索引文件（Sileo/Cydia 读取此文件）
├── Packages.bz2        # 压缩后的索引文件
├── Release             # 仓库元信息
├── pack-arm64.sh       # 打包脚本（将 dylib 打包成 deb）
├── update.sh           # 索引更新脚本（生成 Packages 文件）
└── index.html          # 仓库网页

================================================================================
二、添加新插件的完整流程 ⭐重要⭐
================================================================================

步骤 1: 准备 dylib 文件
------------------------
将 .dylib 或 .zip 文件放入 dylib/ 目录

步骤 2: 运行打包脚本
------------------------
./pack-arm64.sh dylib

可选参数：
./pack-arm64.sh dylib [作者名] [版本号]
例如：./pack-arm64.sh dylib wangdaodao 1.0.0

步骤 3: 更新索引 ⚠️ 关键步骤！
------------------------
./update.sh

⚠️ 注意：这一步必须执行！否则 Sileo 无法刷新出新插件！

步骤 4: 提交并推送
------------------------
git add .
git commit -m "添加新插件"
git push

================================================================================
三、常见问题排查
================================================================================

问题：Sileo 刷新不出新插件
--------------------------
原因：没有运行 ./update.sh 更新索引文件
解决：运行 ./update.sh 后重新提交推送

问题：Packages 文件与 debs 目录不同步
--------------------------
原因：删除/添加 deb 文件后没有更新索引
解决：每次修改 debs/ 目录后都要运行 ./update.sh

问题：dpkg-scanpackages 命令未找到
--------------------------
解决：brew install dpkg

================================================================================
四、快速命令参考
================================================================================

# 一键打包并更新索引
./pack-arm64.sh dylib && ./update.sh

# 查看当前索引的插件数量
grep -c "^Package:" Packages

# 查看 debs 目录中的文件
ls -la debs/

# 完整发布流程（一行命令）
./pack-arm64.sh dylib && ./update.sh && git add . && git commit -m "更新插件" && git push

================================================================================
五、文件说明
================================================================================

pack-arm64.sh
-------------
- 将 dylib/ 目录下的 .dylib 和 .zip 文件打包成 arm64 架构的 .deb
- 自动根据文件名推断 Bundle ID（微信、抖音、小红书等）
- 输出到 debs/ 目录

update.sh
-------------
- 扫描 debs/ 目录，生成 Packages 索引文件
- 生成压缩版 Packages.bz2
- Sileo/Cydia 依赖此文件来获取可用插件列表

Release
-------------
- 仓库元信息（名称、描述、支持的架构等）
- 支持架构：iphoneos-arm64, iphoneos-arm64e

================================================================================
六、注意事项
================================================================================

1. 每次修改 debs/ 目录后，必须运行 ./update.sh
2. 删除插件也需要更新索引
3. 确保 GitHub Pages 已启用（用于在线访问源）
4. Packages 文件中的 Filename 路径必须与实际文件路径一致

================================================================================
                    最后更新：2025-12-12
================================================================================
